{"name":"Vpsinfo","tagline":"Vpsinfo is a Linux server monitoring script, written in PHP, that provides web access to system status information.","body":"![vpsinfo_logo.png](doc/images/vpsinfo_logo.png)\r\n\r\n\r\n\r\n##### Table of Contents\r\n* [Introduction](#intro)\r\n* [General Requirements](#require)\r\n* [Installation](#installation)\r\n* [Requirements for Specific Blocs](#require_bloc)\r\n* [Configuration](#config)\r\n* [Screenshots](#screens)\r\n\r\n\r\n\r\n\r\n<a name=\"intro\"/>\r\n# Introduction\r\n\r\nVpsinfo is a Linux server monitoring script, written in PHP, that provides web access to system status information. It gathers the output from several common Linux commands into one web page, providing a quick overview of the system's current state.\r\n\r\nWhile designed for use on a Linux Virtual Private Server (Virtuozzo or OpenVZ), Vpsinfo also works fine on a dedicated server. When installed on a dedicated machine VPS-specific information is automatically excluded.\r\n\r\nPlease note that, on Virtuozzo and OpenVZ servers, the small beanc helper app may be required to access VPS status information.\r\n\r\nvpsinfo shows the following outputs:\r\n- `top`\r\n- `/proc/user_beancounters` (VPS resources)\r\n- `netstat -nt` (current TCP connections)\r\n- `netstat -ntl` (listening TCP ports)\r\n- `pstree` (tree view of running processes)\r\n- `ls -a /tmp` (and ls -al /tmp )\r\n- `vnstat` (network traffic at the interface)\r\n- `mytop` (MySQL stats)\r\n- `mysqlreport` (perl script, MySQL stats)\r\n- Status of daemon processes\r\n- Top summary section:\r\n\t- Values for oomguarpages and privvmpages (free RAM and swap usage)\r\n\t- Data transfer today through the network interface (from vnstat)\r\n\t- Current number of TCP connections\r\n\t- Web server threads, MySQL threads and queries (from mytop or mysqlreport)\r\n\t- Disk usage\r\n\r\n\r\n## Optional Third-party Software\r\nThese applications are not required to run vpsinfo, but if installed they are used to gather additional information\r\n- vnstat (data transfert monitoring at the network interface) Highly recommended!\r\n- mytop  (MySql monitoring)\r\n- mysqlreport  (perl script, MySql monitoring).\r\n\r\n<a name=\"require\"/>\r\n# General Requirements\r\n- Linux operating system\r\n- webserver ([Nginx](http://nginx.org/), [Apache](http://httpd.apache.org/) ...)\r\n- PHP v5.4+\r\n- Perl\r\n- Gcc compiler (for beanc)\r\n\r\n<a name=\"installation\"/>\r\n# Installation\r\nFor the time being, installation documentation is limited to CentOS. Please share any relevant information you may have that may complete this documentation, and I will include it.\r\n\r\n## Perl\r\nIntallation on CentOS 6.x:\r\n```bash\r\nyum install \\\r\nperl-DBI \\\r\nperl-DBD-mysql --enablerepo=rpmforge-extras\r\n```\r\n*[rpmforge http://repoforge.org/](http://repoforge.org/)\r\n(other perl modules may be needed)\r\n\r\n## Gcc\r\nIntallation on CentOS 6.x:\r\n```bash\r\nyum install \\\r\ngcc \\\r\nglibc-devel \\\r\nglibc-headers\r\n```\r\n(may be incomplete)\r\n\r\n## Web Server\r\n### Nginx\r\nServer configuration bloc example:\r\n```nginx\r\nserver {\r\n\tlisten       \t123.45.67.89:443 ssl;\r\n    server_name  \tVPSINFO.MYSERVER.COM;\r\n\troot \t\t\t/var/www/VPSINFO;\r\n\r\n\t### RESTRICTION ###\r\n\t# your restrictions\r\n\r\n\t### HEADERS ###\r\n\tadd_header  \tCache-Control \t\t\t\t\t\"public\";\r\n\r\n\t### SSL - TLS ###\r\n\tadd_header \t\tStrict-Transport-Security \t\tmax-age=31536000;\r\n\tssl_session_cache           shared:SSL:1m;\r\n\tssl_certificate \t\t\t/etc/pki/https/PUBLIC_CERTIFICATE.crt;\r\n\tssl_certificate_key \t\t/etc/pki/https/PRIVATE_KEY.pem;\r\n    ssl_client_certificate      /etc/pki/CA/SELF_SIGNED_CA_CERTIFICATE.crt;\r\n    ssl_verify_client           on;\r\n\r\n\tssl_protocols               TLSv1.2 TLSv1.1 TLSv1;\r\n\tssl_session_timeout         15m;\r\n\r\n\tssl_ciphers  \t\t\t\tHIGH:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!kEDH:!AESGCM;\r\n\tssl_prefer_server_ciphers\ton;\r\n\r\n\tlocation / {\r\n\t\ttry_files $uri $uri/ /index.php?$args;\r\n\t}\r\n\r\n\t### FAST CGI CONFIGURATION\r\n\tlocation \t~* \t\t\\.php$ {\r\n\t\ttry_files \t\t$uri \t\t=404;\r\n\r\n\t\tfastcgi_pass   \t\t\t\t\tunix:/var/run/php-fpm-www.sock;\r\n\t\tfastcgi_split_path_info \t\t^(.+\\.php)(/.+)$;\r\n\t\tfastcgi_intercept_errors \t\toff;\r\n\t\tfastcgi_index \t\t\t\t\tindex.php;\r\n\t\tfastcgi_param SCRIPT_FILENAME \t$document_root$fastcgi_script_name;\r\n\r\n\t\tinclude \t\t\t\t\t\tfastcgi.conf;\r\n\r\n\t\tfastcgi_cache_valid  \t\t\t60m;\r\n\t}\r\n\r\n\r\n\t### LOGGING ###\r\n}\r\n```\r\nNote the `ssl_client_certificate`. This is actually the server's public certificate, and the private key is installed in my desktop/browser. The first time, in a single run of my browser, the server request a certificate; the browser is aware of my private key and offers to send one of my keys, which I do; then I gain access to my VpsInfo page.\r\n\r\nThe `ssl_verify_client = on` prevents access without a verified certificate.\r\n\r\nUsing a certificate for authentication (vs password) avoids the possibility of password brute force.\r\n\r\n<a name=\"require_bloc\"/>\r\n# Requirements for Specific Blocs\r\n\r\n## [vnstat](http://humdi.net/vnstat/)\r\n\r\nInstallation on CentOS 6.x:\r\n```bash\r\n$ yum install vnstat --enablerepo=rpmforge\r\n```\r\n\r\nConfiguring vnstat:\r\n- get the name of the network interface:\r\n```bash\r\n$ ifconfig\r\n```\r\nyou should see a `venet0` or a `eth0` for KVM's (do not use `venet0:x`).\r\n\r\n- update `/etc/sysconfig/vnstat`:\r\n`VNSTAT_OPTIONS=\"-i venet0\"`\r\n\r\n- you may also need to update `/etc/vnstat.conf`:\r\n`interface \"venet0\"`\r\n\r\n- make sure `/etc/cron.d/vnstat` exists and contains:\r\n`*/5 * * * * vnstat /usr/sbin/vnstat.cron`\r\n\r\n- you can test with:\r\n```bash\r\n$ vnstat -tr\r\n```\r\n\r\n## MySQL Report\r\nThe report should use the included `mysqlreport_a.pl`. For MySql earlier to v5.0, `mytop` seems to be the other option.\r\n\r\n### mysqlreport A\r\nThe included mysqlreport_a.pl is a modified version of mysqlreport (2008) compatible with MySQL/Percona v5+.\r\n\r\n### mysqlreport B\r\nThe included mysqlreport_b.pl is a modified version of [mysqlreport (2015)](https://github.com/jb-boin/mariadb/blob/5.5.30/debian/additions/mysqlreport) compatible with MySQL/Percona v5+ & MariaDB (according to the [author](https://mariadb.atlassian.net/browse/MDEV-573)).\r\n\r\n### [mytop](http://jeremy.zawodny.com/mysql/mytop/)\r\nInstallation on CentOS 6.x:\r\n```bash\r\n$ yum install mytop --enablerepo=epel\r\n```\r\nNote: this option is untested. Mytop was built for MySQL 3.22.x, 3.23.x, and 4.x., but is said to [work](https://www.howtoforge.com/tutorial/mytop-mysql-database-monitoring/#about-mytop) with v5.0 .\r\n\r\n## beanc\r\nbeanc is a 10 lines C program that fetches the old, but still valid, [/proc/user_beancounters](https://wiki.openvz.org/Proc/user_beancounters) data on a Linux [Virtuozzo](http://www.odin.com/products/virtuozzo/) v.3 or [OpenVZ](http://openvz.org/) VPS (Virtual Private Server).\r\n\r\nInstallation on CentOS 6.x:\r\n```bash\r\n$ cd VPSINFO-FOLDER-PATH/installation/beanc/\r\n$ sh install.sh\r\n```\r\n\r\n\r\n<a name=\"config\"/>\r\n# Configuration\r\nThis is a partial list of configuration entries. For the complete list and description, please refer to `config.php`.\r\n\r\n**$vnstat**</br>\r\n`0 = disabled`</br>\r\n`1 = enabled`</br>\r\n\r\n**$mysql_mon**</br>\r\n`0 = none`</br>\r\n`1 = mytop`</br>\r\n`2 = mysqlreport_a   (mysql/percona)`</br>\r\n`3 = mysqlreport_b   (mysql/percona, MariaDB)`</br>\r\n\r\n**$mysql_mon**</br>\r\n`0 = none`</br>\r\n`1 = mytop`</br>\r\n`2 = mysqlreport_a   (mysql/percona)`</br>\r\n`3 = mysqlreport_b   (mysql/percona, MariaDB)`</br>\r\n\r\n**Database Access**</br>\r\nNot needed if `$mysql_mon = 0`.</br>\r\n\r\nSocket has priority if defined.</br>\r\n`$my_socket = '/var/lib/mysql/mysql.sock';`</br>\r\n\r\nThen host IP if no socket. Avoid 'localhost', save a dns lookup.</br>\r\n`$my_host   = '127.0.0.1';`</br>\r\n`$my_port   = '3306';`</br>\r\n\r\nOnly required by mytop</br>\r\n`$my_db     = 'mysql';`</br>\r\n\r\nAnd authentication.</br>\r\n`$my_user   = 'USERNAME';`</br>\r\n`$my_pass   = 'PASSWORD';`</br>\r\n`$userhome = '/USERNAME';`</br>\r\n\r\n**$processes**</br>\r\n`crond dovecot nginx master memcached monitorix mysqld php-fpm rsyslogd sshd vsftpd miniserv`</br>\r\nProcess names that appear in a `ps -e` command output are shown as 'up'.</br>\r\n\r\n\r\n\r\n\r\n<a name=\"screens\"/>\r\n# Screenshots\r\n## Main page</br>\r\n![main.png](doc/images/main.png)\r\n\r\n## Pop-ups\r\n### Top\r\n\r\n![top_ps-aux_a.png](doc/images/top_ps-aux_a.png)</br>\r\nPopup:</br>\r\n![top_ps-aux_b.png](doc/images/top_ps-aux_b.png)\r\n\r\n![top_ps-aux_mem_a.png](doc/images/top_ps-aux_mem_a.png)</br>\r\nPopup:</br>\r\n![top_ps-aux_mem_b.png](doc/images/top_ps-aux_mem_b.png)\r\n\r\n![top_logged_in_user_a.png](doc/images/top_logged_in_user_a.png)</br>\r\nPopup:</br>\r\n![top_logged_in_user_b.png](doc/images/top_logged_in_user_b.png)\r\n\r\n### Netstat\r\n\r\n![netstat_listening_a.png](doc/images/netstat_listening_a.png)</br>\r\nPopup:</br>\r\n![netstat_listening_b.png](doc/images/netstat_listening_b.png)\r\n\r\n![netstat_portlist_a.png](doc/images/netstat_portlist_a.png)</br>\r\nPopup:</br>\r\n![netstat_portlist_b.png](doc/images/netstat_portlist_b.png)\r\n\r\n#### Whois\r\nIn the netstat list:</br>\r\n![netstat_whois_a_foreign_a.png](doc/images/netstat_whois_a_foreign_a.png)</br>\r\nIn the footer of the netstat bloc:</br>\r\n![netstat_whois_a_lookup_a.png](doc/images/netstat_whois_a_lookup_a.png)</br>\r\nPopup:</br>\r\n![netstat_whois_b.png](doc/images/netstat_whois_b.png)\r\n\r\n### Vnstat\r\nClic any one:</br>\r\n![vnstat_a_days.png](doc/images/vnstat_a_days.png) ![vnstat_a_month.png](doc/images/vnstat_a_month.png) ![vnstat_a_sample.png](doc/images/vnstat_a_sample.png)</br>\r\nPopup:</br>\r\n![vnstat_b_month.png](doc/images/vnstat_b_month.png)\r\n\r\n### MySQL Report\r\n![mysql_full_report_a.png](doc/images/mysql_full_report_a.png)</br>\r\nPopup:</br>\r\n![mysql_full_report_b.png](doc/images/mysql_full_report_b.png)\r\n\r\n### Temp files</br>\r\n![ls-al~tmp_a.png](doc/images/ls-al~tmp_a.png)</br>\r\nPopup:</br>\r\n![ls-al~tmp_b.png](doc/images/ls-al~tmp_b.png)\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}